---
title: "BatchPRDS_code"
author: "Lathan Liou"
date: "1/25/21"
output: 
html_document:
  self_contained: no
---



 
<h2>BatchPRDS: Online batch FDR control under Positive Dependence</h2>  <h3>Description</h3>  <p>Implements the BatchPRDS algorithm for online FDR control, where PRDS stands for positive regression dependency on a subset, as presented by Zrnic et al. (2020). </p>   <h3>Usage</h3>  <pre> BatchPRDS(d, alpha = 0.05, gammai, display_progress = FALSE) </pre>   <h3>Arguments</h3>  <table summary="R argblock"> <tr valign="top"><td><code>d</code></td> <td> <p>A dataframe with three columns: identifiers (&lsquo;id&rsquo;), batch numbers (&lsquo;batch&rsquo;) and p-values (&lsquo;pval&rsquo;).</p> </td></tr> <tr valign="top"><td><code>alpha</code></td> <td> <p>Overall significance level of the FDR procedure, the default is 0.05.</p> </td></tr> <tr valign="top"><td><code>gammai</code></td> <td> <p>Optional vector of <i>&gamma;_i</i>. A default is provided with <i>&gamma;_j</i> proportional to <i>1/j^(1.6)</i>.</p> </td></tr> <tr valign="top"><td><code>display_progress</code></td> <td> <p>Logical. If <code>TRUE</code> prints out a progress bar for the algorithm runtime.</p> </td></tr> </table>   <h3>Details</h3>  <p>The function takes as its input a dataframe with three columns: identifiers (&lsquo;id&rsquo;), batch numbers (&lsquo;batch&rsquo;) and p-values (&lsquo;pval&rsquo;). </p> <p>The BatchPRDS algorithm controls the FDR when the p-values in one batch are positively dependent, and independent across batches. Given an overall significance level <i>&alpha;</i>, we choose a sequence of non-negative numbers <i>&gamma;_i</i> such that they sum to 1. The algorithm runs the Benjamini-Hochberg procedure on each batch, where the values of the adjusted significance thresholds <i>&alpha;_{t+1}</i> depend on the number of previous  discoveries. </p> <p>Further details of the BatchPRDS algorithm can be found in Zrnic et al.  (2020). </p>   <h3>Value</h3>  <table summary="R valueblock"> <tr valign="top"><td><code>out</code></td> <td> <p> A dataframe with the original data <code>d</code> and the indicator function of discoveries <code>R</code>. Hypothesis <i>i</i> is rejected if the <i>i</i>-th p-value within the <i>t</i>-th batch is less than or equal to <i>(r/n)&alpha;_t</i>, where <i>r</i> is the rank of the <i>i</i>-th p-value within an ordered set and <i>n</i> is the total number of hypotheses within the <i>t</i>-th batch. If hypothesis <i>i</i> is rejected, <code>R[i] = 1</code> (otherwise <code>R[i] = 0</code>).</p> </td></tr> </table>   <h3>References</h3>  <p>Zrnic, T., Jiang D., Ramdas A. and Jordan M. (2020). The Power of Batching in Multiple Hypothesis Testing. <em>International Conference on Artificial Intelligence and Statistics</em>: 3806-3815 </p>   <h3>Examples</h3>  <pre>  sample.df &lt;- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), batch = c(rep(1,5), rep(2,6), rep(3,4)))  BatchPRDS(sample.df)  </pre>   </body></html> 
